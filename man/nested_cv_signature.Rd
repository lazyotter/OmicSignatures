% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nested_cv_signature.R
\name{nested_cv_signature}
\alias{nested_cv_signature}
\title{Perform Nested Cross-Validation to Derive and Evaluate a Metabolic Signature}
\usage{
nested_cv_signature(data, features, exposure, n_folds = 5, ...)
}
\arguments{
\item{data}{A data.frame or matrix with samples in rows and variables (including features and exposure) in columns.}

\item{features}{A character vector of column names corresponding to the features used to derive the signature.}

\item{exposure}{A character scalar naming the column of the exposure variable to predict.}

\item{n_folds}{Integer. Number of folds to use in the outer CV loop (default is 5).}

\item{...}{Additional arguments passed to \code{create_signature}.}
}
\value{
A data.frame containing model performance metrics (Pearson correlation) for each lambda selection method (\code{l1se} and \code{lmin}).
It includes the following columns:
\describe{
\item{pval}{P-value of the Pearson correlation test.}
\item{est}{Estimated Pearson correlation coefficient between predicted signature and true exposure.}
\item{lower_95}{Lower bound of the 95\% confidence interval for the correlation.}
\item{upper_95}{Upper bound of the 95\% confidence interval for the correlation.}
\item{method}{Lambda selection method used ("l1se" or "lmin").}
\item{exposure}{The name of the exposure variable.}
\item{null_folds}{Number of outer CV folds where no signature was obtained.}
}
}
\description{
This function performs nested cross-validation (CV) to derive a penalized regression signature
of an exposure using selected features, and evaluates its performance in held-out test folds.
The inner CV is used to tune the model (via \code{create_signature}), and predictions are evaluated
in the outer test fold.
}
\details{
This function assumes that signatures are constructed using \code{create_signature()} and evaluated using \code{pred_signature()}.
If no features survive univariate filtering in a given fold, no signature is computed and a warning is issued.
}
\examples{
\dontrun{
results <- nested_cv_signature(data = my_data, features = metabolite_names, exposure = "alcohol")
}

}
